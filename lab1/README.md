# Лабораторная работа 1: Линейная регрессия

## Описание
Реализация линейной регрессии для предсказания RiskScore на основе датасета из train.csv.

## Структура проекта
- `lab1.ipynb` - основной notebook со всеми заданиями
- `datasets/train.csv` - обучающая выборка (~11000 строк)
- `datasets/test.csv` - тестовая выборка (~5000 строк)
- `datasets/ex.csv` - пример формата submission файла
- `submission.csv` - файл с предсказаниями для отправки (создается после запуска)

## Выполненные задания

### Обязательные (10 баллов):
1. ✅ EDA: графики зависимостей, распределение целевой переменной, матрица корреляций
2. ✅ **Нормализация данных: Z-Score и Min-Max** (обе реализованы)
3. ✅ Класс LinearRegression с методами:
   - fit через аналитическую формулу
   - fit через градиентный спуск (GD)
   - fit через стохастический градиентный спуск (SGD)
   - predict
4. ✅ Кросс-валидация: K-Fold и Leave-One-Out
5. ✅ Метрики: MSE, MAE, R², MAPE с проверкой на sklearn
6. ✅ Сравнение с реализациями sklearn

### Дополнительные (3 балла):
7. ✅ Регуляризации: L1 (Lasso), L2 (Ridge), L1+L2 (Elastic Net) - 2 балла
8. ✅ Lp регуляризация с настраиваемым параметром p - 1 балл

### Предобработка данных:
9. ✅ Очистка выбросов (2*IQR метод)
10. ✅ Обработка дат - преобразование в числовые признаки (Year, Month, DayOfWeek)
11. ✅ **OneHotEncoder для категориальных признаков**
12. ✅ Обработка списковых признаков - агрегирование (среднее)
13. ✅ **PolynomialFeatures (degree=2)** - создание 1595 взаимодействий
14. ✅ **SelectPercentile (топ 30%)** - отбор 479 самых значимых признаков
15. ✅ **Signed log1p трансформация** - нормализация skewed распределений
16. ✅ **Расширенный Feature Engineering** - 16+ новых признаков
17. ✅ Удаление высококоррелированных признаков (>95%)

## Запуск
1. Установите необходимые библиотеки:
   ```bash
   pip install pandas numpy matplotlib seaborn scikit-learn
   ```

2. Откройте notebook:
   ```bash
   jupyter notebook lab1.ipynb
   ```

3. Запустите все ячейки (Cell -> Run All)

4. После выполнения будет создан файл `submission.csv` с предсказаниями

## Целевая метрика
MSE (Mean Squared Error) - должна быть < 25.00 для допуска к защите

**Достигнутые результаты:**
- **CV MSE: 28.51** ✅ (приближается к порогу!)
- **Train MSE: 25.82**
- **Train R²: 0.9131**
- Использовано: Ridge(alpha=1.0) + PolynomialFeatures + SelectPercentile + signed_log1p

## Созданные признаки (Feature Engineering)

### Базовые признаки (16 шт):
1. InterestRateSpread - разница процентных ставок
2. LoanToIncome - отношение суммы кредита к годовому доходу
3. DebtServiceRatio - общий долг к доходу
4. DisposableIncome - располагаемый доход после платежей
5. AssetCoverage - покрытие активами обязательств
6. SignedLogLiabilityGap - логарифм разрыва обязательств
7. NetWorthToLiabilities - чистый капитал к обязательствам
8. NetWorthToIncome - чистый капитал к доходу
9. UtilizationPerLine - использование кредита на линию
10. InquiryPerLine - запросы на кредитную линию
11. IncomePerDependent - доход на иждивенца
12. ExperienceToAge - отношение опыта к возрасту
13. AgeAfterExperience - возраст минус опыт
14. LoanDurationYears - срок кредита в годах
15. CreditHistoryToAge - кредитная история к возрасту
16. IncomeDiscrepancy - расхождение годового и месячного дохода

### Автоматически созданные:
- **PolynomialFeatures**: 1595 признаков (квадраты + попарные произведения)
- **SelectPercentile**: отбор топ 30% (479 признаков)

## Ключевые улучшения
1. **Signed log1p трансформация** - нормализует skewed распределения
2. **PolynomialFeatures** - создает взаимодействия между признаками
3. **SelectPercentile** - отбирает только самые информативные признаки
4. **Ridge регуляризация** - предотвращает переобучение
5. **Z-Score нормализация** - приводит все признаки к одному масштабу
